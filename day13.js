let map = Array.from(String.raw`    /-----------------------\                                   /-------------\                                                                       
    |            /----------+-----------------------------------+----\        |                                                /-----------\          
    |            |        /-+---------------------\             |    |        |             /----------------------------------+------\    |          
    |            |        | |   /-----------------+-------------+---\|        |             |                                  |      |    |          
    |         /--+--------+-+--\|  /--------------+-------------+---++--\     | /-----------+----------------------------------+------+---\|          
 /--+---------+--+--------+-+--++--+--------------+-------------+---++--+-----+-+-----------+------------\                     |      |   ||          
 |  |         |  |        | |  ||  |              |            /+---++--+-----+-+-----------+------------+---------------------+------+---++-------\  
 |  |         |  |        | |  ||  |         /----+------------++\  ||  |     | |           |            |            /--------+------+--\||       |  
 |  |         |  |       /+-+--++--+---------+----+------------+++--++--+---\ | |           |            |            |        |      |  |||       ^  
 |  |         |  |   /---++-+--++--+---------+--\ |            |||  ||  |   | | |      /----+------------+------------+--------+------+--+++----\  |  
 |  |         |  |   |/--++-+--++--+---------+--+-+------------+++-\||  |   | | |      |    |            |            |        |      |  |||    |  |  
 |  |         | /+---++--++-+--++--+--------\|  | |            |\+-+++--+---+-/ |      |    |            |            |        |      |  |||    |  |  
/+--+---------+-++---++--++-+--++--+--------++--+-+-<----------+-+-+++--+---+---+------+----+----------\ |            |        |      |  |||    |  |  
||  |         | ||   ||  || |  ||  |       /++--+-+------------+-+-+++--+---+---+------+----+----------+-+------------+-\      |      |  |||    |  |  
||  |         | ||   ||  || |  ||  |    /--+++--+-+------------+-+-+++--+---+\  |      |    |      /---+-+------------+-+------+------+-\|||    |  |  
||  |         | ||   ||  || |  || /+----+--+++--+-+\          /+-+-+++--+-\ ||  |      |    |      |   | |     /------+-+-\    |      | ||||    |  |  
||/-+---------+\||   ||  || |  || ||    |  |||  | ||          || | |||  | | ||  |      |    |      |   | |  /--+------+-+-+\   |      | ||||    |  |  
||| |         ||||   ||  || |  || ||    |  |||  | ||      /---++-+-+++--+-+-++--+------+----+------+-\ | |  |  |      | | ||   |      | ||||    |  |  
||| |   /-----++++---++--++-+--++-++----+--+++--+-++------+---++-+-+++--+-+-++--+------+----+------+-+-+-+-\|  |      \-+-++---+------+-+/||    |  |  
||| |   |     ||||   ||  || |  |\-++----+--+++--+-++------+---++-+-+/|  | | ||  |      |    |      | | | | ||  |        | ||   |      | | ||    |  |  
||| |   |     ||||  /++--++-+--+--++----+--+++--+-++----->+---++-+-+-+--+-+-++--+------+----+------+-+-+-+-++--+--------+-++--\|      | | ||    |  |  
||| |   |     ||||  |||  |\-+--+--++----+--+++--+-/|/-----+---++-+-+-+--+-+-++--+------+----+------+\| | | ||  |        | ||  ||      | | ||    |  |  
||| |   |     ||||  |||  |  |  |  ||    |  |||  |  ||     |   || |/+-+--+-+-++--+------+----+---\ /+++-+-+-++--+-----\  | ||  ||      | | ||    |  |  
||| |   |     |||| /+++--+--+--+--++----+--+++--+--++-----+---++-+++-+--+-+\||  |      |    |   | |||| | | ||  | /---+--+-++--++-----\| | ||    |  |  
||| |   |     |||| ||||  |  |  |  ||  /-+--+++--+--++-----+---++-+++-+--+-++++--+------+----+---+-++++\| | ||  | |   |  | ||  ||     || | ||    |  |  
||| |   |     |||| ||||  |  |  |  \+--+-+--+++--+--/|     |   |\-+++-+--+-++++--+------+----+---+-++++++-+-++--+-+---+--+-++--++-----++-+-++----+--/  
||| | /-+-----++++-++++--+--+--+---+--+-+--+++--+---+-----+---+--+++-+--+-++++--+\     |    |   | |||||| | ||  | |   |  | ||  ||     || | ||    |     
||| | | |     |||| ||||  |  |  |   |  | |  |||  |   |     |   |  ||| |/-+-++++--++-----+----+---+-++++++-+-++--+-+---+--+-++--++-----++-+\||    |     
||| | | |     |||| ||||  |  |  |   |  | |  |||  |   |     |   |  ||| || | ||||  ||     |    |   | |||||| | ||  | |   |  | ||  ||     || ||||    |     
||| | | |    /++++-++++--+--+--+---+--+-+--+++--+---+-----+---+--+++-++-+-++++--++-----+----+---+-++++++-+-++\ | |   |  | ||  ||     || ||||    |     
||| | | |    ||||| ||||  |  |  |   |  | |  |||  |   |     |   |  ||| || | ||||  ||     |    |   | |||||| | ||| | |   |  | ||  ||     || ||||    |     
||| | | |    ||||| ||||  |  |  |   |  | \--+++--+---+-----+---+--+++-++-+-+++/  ||    /+----+---+-++++++-+-+++-+-+\  |  | ||  ||     || ||||    |     
||| | | |    ||||| ||||  |  |  |   \--+----+++--+---+-----+---+--+++-++-/ |||   ||    ||    |   | |||||| | ||| | \+--+--+-++--++-----/| ||||    |     
||| | | |    ||||| ||||  |  |  |      |    |||  |   |     |   |  ||| ||  /+++---++----++----+---+-++++++-+-+++-+--+--+--+-++\ ||      | ||||    |     
||| | | |    ||||| |\++--+--+--+------+----+++--+---+-----+---+--+++-++--++++---++----++----+---+-++++++-+-+++-+--+--+--+-+++-/|      | ||||    |     
||| | | |    ||||| | ||  |  |  |      |    |||  |   |     |   |  ||| ||  ||||   ||    ||    |   | ||||||/+-+++-+--+-\|  | |||  |      | ||||    |     
||| | | |    ||||| | ||  |  |  |      \----+++--+---+-----+---+--+++-++--++++---++----++----+---+-++++/||| |\+-+--+-++--+-+/|  |      | ||||    |     
||| | | |    ||||| | ||  |  |  |           |||/-+---+-----+---+--+++-++--++++---++----++----+---+-++++-+++-+-+-+--+-++--+-+<+--+------+-++++-\  |     
||| | | |/---+++++-+-++--+--+--+---------\ |||| |   |     |   |  ||| ||  ||||   ||    ||    |   | |||| ||| | | |  | ||  | | |  |      | |||| |  |     
||| | | ||   ||||| | ||  |  |  |         |/++++-+---+-----+---+--+++-++--++++---++----++----+---+-++++-+++-+-+-+--+-++--+-+-+--+------+\|||| |  |     
||| | | ||   ||||| | ||  |  |  |        /++++++-+---+-----+---+--+++-++--++++---++----++----+---+-++++-+++-+-+\|  | ||  | | |  |      |||||| |  |     
||| | | ||   ||||| | ||  |/-+--+--------+++++++-+---+-----+---+-\||| ||  |||| /-++----++\   |   | |||| ||| | |||  | ||  | | |  |      |||||| |  |     
||| | | ||   ||||| | ||  || |  |        ||||||| |   |     |  /+-++++-++--++++-+-++----+++---+---+-++++-+++-+-+++--+-++--+-+-+--+--\   |||||| |  ^     
||| | | ||   ||||| | ||  || |  |        ||||||| |   |     |  || ||||/++>-++++-+-++----+++---+---+-++++-+++-+-+++--+-++--+-+-+--+--+---++++++-+--+\    
||| | | ||   ||||| | ||  || |  |        ||||||| |   |    /+--++-+++++++--++++-+-++----+++---+---+-++++-+++-+-+++--+-++--+-+-+--+\ |   |||||| |  ||    
||| | | ||/--+++++-+-++--++-+--+--------+++++++-+---+----++--++-+++++++--++++-+-++----+++--\|   | |||| ||| | ||\--+-++--+-/ |  || |   |||||| |  ||    
||| | | |||  ||||| | ||  || |  |        ||||||| |   |    ||  || |||||||  |||| | ||    |||  ||   | |||| ||| | ||   | ||  |   |  || |   |||||| |  ||    
||| | | |||  ||||| | ||  || |  |     /--+++++++-+---+----++--++-+++++++--++++-+-++----+++--++---+-++++-+++-+-++---+-++--+--\|  || |   |||||| |  ||    
||| \-+-+++--+++++-+-++--++-/  |     |  ||||||| |   |    |\--++-+++++++--++++-+-++----+++--++---+-+++/ ||| | ||   | ||  |  |v  || |   |||||| |  ||    
|||   | |||  ||||| | |\--++----+-----+--+++++++-+---+----+---++-+++/|||  |||| | ||    |||  ||   | |||  ||| | ||   | ||  |  ||  || |   |||||| |  ||    
|||   | |||  ||||| | |   ||    |   /-+--+++++++-+---+----+---++-+++-+++--++++-+-++----+++--++---+-+++--+++-+-++---+-++--+--++-\|| |   |||||| |  ||    
|||   | |||  ||||| |/+---++----+---+-+--+++++++-+---+----+---++-+++-+++--++++-+-++----+++\ ||   | |||  ||| | ||   | ||  |  || ||| |   |||||| |  ||    
|||   | |||  ||||| |||   ||    |   | |  ||||||| |   |    |   || ||| |||  |||| | ||    |||| ||   | |||  ||| | ||   | ||  |  || |\+-+---+++++/ |  ||    
|||   | |||  ||||| |||   ||    |   | |  ||||||| |   |    |   || ||| |||  |||| | ||    |||| ||   | |||  ||| | ||   | ||  |  || | | |   |||||  |  ||    
|||  /+-+++--+++++\|||   ||    |   | |  ||||||| |   |    |/--++-+++-+++--++++-+-++----++++\||   | |||  ||| | ||   | ||  |  || | | |   |||||  |  ||    
|||  || |||  |||||||||   ||    |   | |  ||||||| |   |    ||  || ||| |||  |||v | ||    |||||||  /+-+++--+++-+-++---+-++--+--++-+-+-+---+++++--+--++\   
|||  || |||  |||||||||   ||    |   | |  ||||||| |   |    ||/-++-+++-+++--++++-+-++----+++++++--++-+++--+++-+-++---+-++--+--++-+-+-+\  |||||  |  |||   
|||  || |||/-+++++++++---++----+---+-+--+++++++-+---+---\||| || ||| |||  |||| | ||    |||||||  || |||  ||| | ||   | ||  |  || | | ||  |||||  |  |||   
|||  || |||| |||||||||   ||    |   | |  ||||||| |  /+---++++-++-+++-+++\ |||| | ||    |||||||  || |||  ||| | ||   | ||  |  || | | ||  |||||  |  |||   
|||  || |||| |||||||||   ||    |   | |  ||||||| |  ||   |||| || ||| |||| |||| | ||    |||||||  ||/+++--+++-+-++---+-++--+--++-+-+-++--+++++--+--+++--\
|||  || |||| |||||||||   ||    |   | |  ||||||| |  ||   |||| || ||| |||| |||| | ||    |||||||  ||||||  ||| | ||   | || /+--++-+-+-++--+++++--+\ |||  |
|||  || |||| |||||||||   ||    |   | |  ||||||| |  ||   |||| || ||| |||| |||| | ||    |||||||  ||||||  ||| | ||   | || ||  || | | ||  |||||  || |||  |
|||  || |||| |||||||||   ||    | /-+-+--+++++++-+--++---++++-++-+++-++++-++++-+-++----+++++++--++++++--+++-+-++---+-++-++--++-+-+\||  |||||  || |||  |
|||  || |||| |||||||||/--++----+-+-+-+--+++++++-+--++---++++-++-+++-++++-++++-+-++----+++++++--++++++--+++-+-++-\ | || ||  || | ||||  |||||  || |||  |
|||  || |||| ||||||||||  || /--+-+-+-+--+++++++-+--++---++++-++-+++-++++-++++-+-++<---+++++++\ ||||||  ||| | || | | || ||  || | ||||  |||||  || |||  |
|||  ||/++++-++++++++++--++-+--+\| | |  ||||||| |/-++---++++-++-+++-++++-++++-+-++----++++++++-++++++-\||| | || | | || ||  || | ||||  |||||  || |||  |
|||  ||||||| \+++++++++--++-+--+++-+-+--+++++++-++-++---++++-++-+++-++++-++++-+-++----++++++++-++++++-++++-+-/| | | || ||  || | ||||  |||||  || |||  |
|||  |||||\+--+++++++++--++-+--+++-+-+--+++++++-++-++---++++-++-+++-++++-++++-+-++----+++++/|| \+++++-++++-+--+-+-+-++-++--++-+-++++--+++++--++-++/  |
|||  ||||| |  |||||||||  || |  ||| \-+--+++++++-++-++---++++-++-+++-++++-++++-+-++----+++++-++--+++++-++++-+--+-+-+-++-++--++-/ ||||  |||||  || ||   |
|||  ||||| |  ||||||\++--++-+--+++---+--+++++++-++-++---++++-++-+++-++++-++++-+-++----+++/| ||  ||||| |||| |  | | | || ||  ||   ||||  |||||  || ||   |
|||  ||||| |  |||||| ||  || |/-+++---+--+++++++-++-++---++++-++-+++-++++-++++\| ||    ||| | ||  ||||| |||| |  | | | || ||  ||   ||||  |||||  || ||   |
|||  |\+++-+--++++++-++--++-++-+++---+--+++++++-++-++---++++-++-+++-++++-++++++-+/    ||| | ||  |||||/++++-+--+-+-+-++-++--++\  ||||  |||||  || ||   |
|||  | ||| |  |||||| ||  || || |||   |  ||||||| || \+---++++-++-+++-+++/ |||||| |     |\+-+-++--++++++++++-+--+-+-+-++-++--+++--++++--+++++--++-/|   |
|||  | ||| |  |||||| ||  || ||/+++---+--+++++++-++--+---++++-++-+++-+++--++++++-+-----+-+-+-++--++++++++++-+--+-+-+-++-++--+++-\||||  |||||  ||  |   |
|||  | ||| |  |||||| ||  || ||||||   |  ||||||| ||  |   |||| || ||| |||/-++++++-+-----+-+-+-++--++++++++++-+-\| | | || \+--+++-+++++--+++++--+/  |   |
|||  | ||| \--++++++-++--++-++++++---+--+++++++-++--+---/||| |\-+++-++++-+/|||| |     | | | ||/-++++++++++-+-++-+-+-++--+--+++-+++++--+++++\ |   |   |
|||/-+-+++----++++++-++--++-++++++-\ |/-+++++++-++--+----+++\|  ||| |||| | |||| |     | | | ||| |||||||||| | || | | ||  |  ||| |||||  |||||| |   |   |
|||| | |||    |||||| ||  || |||||| | || |||||\+-++--+----+++++--+/| |||| \-++++-+-----+-+-+-+++-++++++++++-+-++-+-+-++--+--+/| |||||  |||||| |   |   |
|||| | |||    |||||| ||  || |||||| | || ||||| | ||  |    |||||  | | ||\+---++++-+-----+-+-+-+++-++++++++++-+-++-+-+-++--+--+-+-+++++--+++/|| |   |   |
|||| | |||    |||||| ||  || |||||| | || ||||| | ||  |    |||||  | | || |   |||| |     | | | \++-++++++++++-+-++-+-+-++--+--+-+-+++++--/|| || |   |   |
|||| | |||    |||||| ||  || |||||| | || ||||| | ||  |    |||||  | | || |   |||| |     | | |  || ||\+++++++-+-++-+-+-+/  |  | | |||||   || || |   |   |
\+++-+-+++----++++++-++--++-++++++-+-++-+++++-+-++--+----+++++--+-+-++-+---++++-+-----+-+-+--++-++-++++/|| | || | | |   |  | | |||||   || || |   |   |
 ||| | |||    |||||| ||  || \+++++-+-++-+++++-+-++--+----+++++--+-+-++-+---++++-+-----+-+-+--/| || |||| || | || | | |   |  | | |||||   || || |   |   |
 ||| | |||    |||||| ||  ||  ||||| | || ||||| | ||/-+----+++++--+-+-++-+---++++-+-----+-+-+---+-++-++++-++-+-++-+-+-+---+--+-+-+++++\  || || |   |   |
 ||| | |||    |||||| ||  ||  ||||| | || ||||| | ||| |    |||||  | | || |   |||| |     | | |   | || |||| || | || | | |   |  | | ||||||  || || |   |   |
 ||| | \++----++++++-++--++--+++/| | || ||||| | ||| |    ||\++--+-+-++-+---++++-+-----+-+-+---+-++-++++-++-+-++-+-+-+---+--+-+-++++/|  || || |   |   |
 ||| |  ||    |||||| ||  ||  ||| | | || ||||| | ||| |    || ||  | | || |   |||| |     | | |   | || ||\+-++-+-++-+-+-+---+--+-/ |||| |  || || |   |   |
 ||| |  ||    |||||| ||  ||  ||| | | || ||||| | ||| |    || ||  | \-++-+---++++-+-----+-+-+---+-/| || | || | || | | |   |  |   |||| |  || || |   |   |
 ||| |  ||    |||||| ||  \+--+++-+-+-++-+++++-+-+++-+----++-++--+---++-+---+/|| |     | | |   \--+-++-+-++-+-++-+-+-+---+--+---++++-+--++-+/ |   |   |
 ||| |  ||    |||||| ||   |  ||| \-+-++-+++++-+-+++-+----++-++--+---++-+---+-++-+-----+-+-+------+-++-+-++-+-++-+-+-+---+--+---++/| |  || |  |   |   |
 ||| |  ||    |||||| ||/--+--+++---+-++-+++++-+-+++-+----++-++--+---++-+---+-++-+-----+-+-+------+-++-+-++-+-++-+-+\|   |  |   || | |  || v  |   |   |
 ||| | /++----++++++-+++--+-\|||   | \+-+++++-+-+++-+----++-++--+---++-+---+-++-+-----+-+-+------+-++-+-++-+-++-+-+++---+--/   || | |  || |  |   |   |
 ||| | |||    |||||| |||  | ||||   |  | ||||| | ||| |    || ||  |   || |   | ||/+-----+-+-+------+-++-+-++-+-++-+-+++---+------++-+-+--++-+--+---+-\ |
 \++-+-+++----++++++-+++--+-++++---+--+-+++++-+-+++-+----++-++--+---++-+---+-++++-----+-+-+------+-++-+-+/ | || | |||   |      || | |  || |  |   | | |
/-++-+-+++----++++++-+++--+-++++--\|  | ||||| | ||| |    \+-++--+---++-+---+-++++-----+-+-+------+-++-+-+--+-++-+-+++---+------+/ | |  || |  |   | | |
| || | |||    |||||| |||  | ||||  ||  | ||||| | ||| |     \-++--+---++-+---+-++++-----+-+-/      | || | |  | ||/+-+++---+------+--+-+--++-+--+---+\| |
| || | |^|    |||||| |||  | ||||  ||  | ||||| | ||| |       || /+---++-+---+-++++-----+-+--------+-++-+-+--+-++++-+++---+------+--+-+--++-+--+\  ||| |
| || | |||    \+++++-+++--+-+++/  ||  |/+++++-+-+++-+-\     || ||   || |   | ||||   /-+-+--------+-++-+-+--+-++++-+++---+------+--+-+--++-+-\||  ||| |
| || | |||     ||||| |||  | |||   ||  ||||||| | ||| | |     || ||   || |   | |||\---+-+-+--------+-++-+-+--+-++++-+++---+------+--+-+--++-/ |||  ||| |
| || | |||    /+++++-+++--+-+++---++--+++++++-+-+++-+-+-----++-++---++-+---+-+++--\ | | |        | || | |  |/++++-+++---+------+--+-+--++-\ |||  ||| |
| || | |||  /-++++++-+++--+-+++---++--+++++++-+-+++-+-+-----++-++---++-+\  | |||  | | | |        | \+-+-+--++++++-+++---+------+--+-+--+/ | |||  ||| |
| || | |||  | |||||\-+++--+-+++---++--+++++++-+-+++-+-+-----++-++---++-++--/ |||  |/+-+-+------\ |  | | |  |||||| |||   |      |  | |  |  | |||  ||| |
| |\-+-+++--+-+++++--+++--+-+++---+/  \++++++-+-+++-+-+-----/| ||   || ||    |||  ||| | |      | |  | | |  |||||| |||   |      |  | |  |  | |||  ||| |
| |  | |||  | |||\+--+++--+-+++---+----++++++-+-+++-+<+------+-++---+/ \+----+++--+++-+-+------+-+--+-+-+--++/||| |||   |      |  | |  |  | |||  ||| |
| |  | |||  | ||| |  |||  | |||   |    |||||| | ||| | |      | ||   |   |    |||  ||| | |      | |  | | |  || ||| |||   |      |  | |  |  | |||  ||| |
\-+--+-+++--+-+++-+--+++--+-+++---/    |||||| | ||| | |      | ^|   |   |    |||  ||| | |      | |  | | \--++-+++-++/   |      |  | |  |  | |||  ||| |
  |  | |||  | ||| |  |||  | |||        |||||| | ||| | |      | ||   \---+----+++--+++-+-+------+-+--+-+----++-+++-++----+------+--+-+--+--+-+++--/|| |
  |  | |||  | ||| |  |||  | |||        ||||\+-+-+++-+-+------+-++-------+----+++--+++-+-+------+-+--+-+----++-+++-++----/      |  | |  |  | |||   || |
  |  | \++--+-+++-+--+++--+-/||        |||| | | ||| | |      | ||       |    |||  ||| | |      | |  | |    || ||| ||           |  | |  |  | |||   || |
  |  |  ||  | ||| |  |||  |  ||        |||| | | ||| | |      | ||       |    |||  ||| | |   /--+-+--+-+----++-+++-++-----------+--+<+--+-\| |||   || |
  |  |  ||  | ||| |  |||  |  ||        |\++-+-+-+++-+-+------+-++-------+----+++--+++-+-+---+--+-+--+-+----++-/|| ||           |  | |  | || |||   || |
  |  |  ||  | ||| |  |||  |  ||        | || | | ||| | |  /---+-++-------+----+++--+++-+-+---+--+-+--+-+----++--++-++-----------+--+-+--+-++\|||   || |
  |  |  ||  |/+++-+--+++--+--++--------+-++-+-+-+++-+-+--+---+-++-------+----+++--+++-+-+\  |  | |  | |    ||  || ||           |  | |  | ||||||   || |
  |  \--++--+++++-/  |||  |  ||        | || | | ||| | |  |   | ||       |    ||\--+++-+-++--+--+-+--+-+----++--++-++-----------+--+-+--+-++++++---+/ |
  |     ||  |||||    |||  |  ||        | || | \-+++-+-+--+---+-++-------+----++---+++-+-++--+--+-+--+-+----++--++-++-----------+--+-+--+-++++/|   |  |
  |     ||  |||||    \++--+--++--------+-++-+---/|| | |  |   | ||       |/---++---+++-+-++--+--+-+--+-+----++--++-++-----------+\ | |  | |||| |   |  |
  \-----++--+++/|     ||  |  ||        | || |    || | |  |   | ||       ||/--++---+++-+-++--+--+-+--+-+----++--++-++-\         || | |  | |||| |   |  |
        ||  ||| \-----++--+--++--------+-++-/    || \-+--+---+-++-------+++--++---+++-+-++--+--+-+--/ |    ||  || || |         || | |  | |||| |   |  |
        ||  |||       ||  |  ||        | |\------++---+--+---+-++-------+++--++---+++-+-++--+--+-+----+----++--++-++-+---------++-+-+--/ |||| |   |  |
        \+--+++-------++--+--++--------+-+-------++---+--+---+-++-------+++--++---+++-+-++--+--+-+----+----/|  || || |         || | |    |||| |   |  |
         |  |||       ||  |  ||        | |       ||   |  \---+-++-------+++--++---+++-+-++--+--+-+----+-----+--++-++-+---------++-+-+----++/| |   |  |
         |  |||       ||  |  ||        | |       ||   |      | ||       |||  ||   ||| | ||  |  | |    |     \--++-++-+---------++-+-+----+/ | |   |  |
         |  |||    /--++--+--++--------+-+-------++---+------+-++-------+++--++---+++-+-++--+--+-+----+------\ || || |         || | |    |  | |   |  |
         |  \++----+--++--+--++--------+-+-------++---+------+-++-------/||  ||   ||| | ||  |  | |    |      | || || |         || | |    |  | |   |  |
         |   ||    |  ||  |  ||        \-+-------++---/      | ||        ||  ||   ||| | ||  |  | \----+------+-++-++-+---------++-+-+----+--+-+---+--/
         |   ||    |  ||  |  ||          |     /-++>---------+-++--------++--++---+++-+-++--+--+------+-\    | || || |         || | |    |  | |   |   
         |   ||    |  ||  |  ||          |     | ||          | ||        ||  ||  /+++-+-++--+--+------+-+----+\|| || |         || | |    |  | |   |   
         |   ||/---+--++--+--++----------+-----+-++------\   | ||        ||/-++--++++-+-++--+--+------+-+----++++-++-+--------\|| | |    |  | |   |   
         |   |||   |  ||  |  ||          |     | ||      |   | ||        ||| ||  |||| | ||  |  |      | |    |||| || |        ||| v |    |  | |   |   
         |   |||   |  ||  |  \+----------+--->-+-++------+---+-++--------+++-/|  |||| | ||  |  |      | |/---++++-++-+-------\||| | |    |  | |   |   
         |   |||   |  |\--+---+----------+-----+-++------+---+-++--------+++--+--++++-+-++--+--+------+-++---++++-+/ |       |||| | |    |  | |   |   
         |   |||   |  |   |   |          |     | ||      |   | ||        |||  |  |||\-+-++--+--+------+-++---++++-+--+-------++++-+-+----+--/ |   |   
         |   |||   |  |   \---+----------+-----+-++------+---+-+/        |||  |  |||  \-++--+--+------+-++---++++-/  |       |||| | |    |    |   |   
      /--+---+++---+--+-------+----------+--\  | ||      |   | |         |||  |  ||\----++--+--/      | ||   ||||    |       |||| | |    |    |   |   
      |  |   |||   |  |       \----------+--+--+-++------+---+-+---------+++--+--++-----++--+---------+-++---++++----+-------++/| | |    |    |   |   
      |  |   |||   |  \------------------+--+--+-++------+---+-+---------+++--+--++-----++--+---------+-++---+++/    |       || | | |    |    |   |   
      |  |   |||   |                     |  |  | ||      |   | |         |||  |  \+-----++--+---------+-++---+/|     |       || | | |    |    |   |   
      |  |   ||\---+---------------------+--+--+-++------/   | |         |||  \---+-----/|  \---------+-++---+-+-----+-------++-+-+-+----/    |   |   
      |  |   ||    \---------------------+--+--+-++----------+-+---------+++------+------+------------+-++---/ |     |       || | | |         |   |   
      |  |   ||                          |  |  \-++----------+-+---------+++------+------+------------+-/|     |     |       || | | |         |   |   
      |  \---++--------------------------/  |    ||          \-+---------+++------+------+------------+--+-----+-----+-------++-+-/ |         |   |   
      |      ||                             |    ||            |         |||      |      |            |  |     |     |       || |   |         |   |   
      |      ||                             |    ||            |         \++------+------+------------+--+-----+-----+-------++-/   |         |   |   
      |      |\-----------------------------+----++------------+----------++------/      |            |  |     |     |       ||     |         |   |   
      \------+------------------------------/    ||            |          \+-------------+------------+--+-----+-----/       ||     |         |   |   
             |                                   \+------------+-----------+-------------+------------/  \-----+-------------/|     |         |   |   
             |                                    \------------+-----------+-------------+---------------------+--------------+-----/         |   |   
             \-------------------------------------------------+-----------+-------------/                     \--------------+---------------+---/   
                                                               |           \--------------------------------------------------/               |       
                                                               \------------------------------------------------------------------------------/       `)

function coords(x,y,update) {
  if (!update)
    return map[y*151 + x]
  else {
    map[y*151 + x] = update[0]
    // console.log('updating ',x,y,' to ',update[0],map[y*151 + x])    
  }
}

const carts = []

function findCarts() {
  for (y=0; y<150; y++) {
    for (x=0; x<150; x++) { 
      let current = coords(x,y)
      if (['<','>','^','v'].includes(current)) {
        let cart = {x:x, y:y, v:current, n:0}
        carts.push(cart)
        // console.log(cart)
        // console.log(coords(x-1,y-1),coords(x,y-1),coords(x+1,y-1))
        // console.log(coords(x-1,y),coords(x,y),coords(x+1,y))
        // console.log(coords(x-1,y+1),coords(x,y+1),coords(x+1,y+1))
      }
      switch (current) {
        case '<':
          // carts.push({x:x, y:y, v:'<'})
          if (x<149 && ['-','+'].includes(coords(x+1,y)))
            coords(x,y,'-')
          else
            console.log('uh?')
          break;
        case '>':
          // carts.push({x:x, y:y, v:'>'})
          if (x>0 && ['-','+'].includes(coords(x-1,y)))
            coords(x,y,'-')
          else
            console.log('uh?')
          break;
        case '^':
          // carts.push({x:x, y:y, v:'^'})
          if (y<149 && ['|','+'].includes(coords(x,y+1)))
            coords(x,y,'|')
          else
            console.log('uh?')
          break;
        case 'v':
          // carts.push({x:x, y:y, v:'v'})
          if (y>0 && ['|','+'].includes(coords(x,y-1)))
            coords(x,y,'|')
          else
            console.log('uh?')
          break;
      }
    }
  }
}

function whereNow(from, to, cart) {
  switch(from+to) {
    case '||': 
    case '--': 
    case '/-': 
    case '\\-': 
    case '/|': 
    case '\\|': 
    case '+-': 
    case '+|': return 0; // stay course
    case '-/': 
    case '|\\': return 1; // turn left
    case '-\\': 
    case '|/': return 2; // turn right
    case '-+': 
    case '|+': 
    case '++': 
    case '/+': 
    case '\\+': return 3; // prog turn
    case '+\\':
      switch (cart.v) {
        case '^': return 1;
        case 'v': return 1;
        case '<': return 2;
        case '>': return 2;
      }
      break;
    case '+/':
      switch (cart.v) {
        case '^': return 2;
        case 'v': return 2;
        case '<': return 1;
        case '>': return 1;
      }
      break;
    default:
      console.log('Crash? ',from, to)
  }
}

function turnLeft(cart) {
  switch (cart.v) {
    case '<': cart.v = 'v'; break      
    case '>': cart.v = '^'; break
    case '^': cart.v = '<'; break
    case 'v': cart.v = '>'; break
  }
}

function turnRight(cart) {
  switch (cart.v) {
    case '<': cart.v = '^'; break      
    case '>': cart.v = 'v'; break
    case '^': cart.v = '>'; break
    case 'v': cart.v = '<'; break
  }
}

function turnCart(cart, where) {
  switch (where) {
    case 1: turnLeft(cart); break;
    case 2: turnRight(cart); break;
    case 3: 
      cart.n++;
      if (cart.n%3 == 1)
        turnLeft(cart)
      if (cart.n%3 == 0)
        turnRight(cart)
      break;
  }
}

function collision(x,y) {
  for (i=0; i< carts.length; i++) {
    if (carts[i].x == x && carts[i].y == y) {
      console.log("Collision ",x,y," removing ",carts[i])
      carts.splice(i,1)
      return true;
    }
  }
}

function removeCart(cart) {
  for (i=0; i< carts.length; i++) {
    if (cart === carts[i]) {
      carts.splice(i,1)
    }
  }
}

function moveCart(cart) {
  switch(cart.v) {
    case '<':    
      if (collision(cart.x-1, cart.y)) {
        removeCart(cart)
        return;
      }
      cart.x = cart.x-1
      turnCart (cart, whereNow(coords(cart.x+1, cart.y), coords(cart.x, cart.y), cart)) 
      break;
    case '>':
      if (collision(cart.x+1, cart.y)) {
        removeCart(cart)
        return;
      }
      cart.x = cart.x+1
      turnCart (cart, whereNow(coords(cart.x-1, cart.y), coords(cart.x, cart.y), cart)) 
      break;
    case '^':
      if (collision(cart.x, cart.y-1)) {
        removeCart(cart)
        return;
      }
      cart.y = cart.y-1
      turnCart (cart, whereNow(coords(cart.x, cart.y+1), coords(cart.x, cart.y), cart)) 
      break;
    case 'v':
      if (collision(cart.x, cart.y+1)) {
        removeCart(cart)
        return;
      }
      cart.y = cart.y+1
      turnCart (cart, whereNow(coords(cart.x, cart.y-1), coords(cart.x, cart.y), cart)) 
      break;
  }
}

findCarts()

let t=1;
let last=false
do {
  carts.sort((a,b) => {
    if (a.y==b.y)
      return a.x - b.x
    else
      return a.y - b.y
  })
  carts.forEach(moveCart)
  last = carts.length == 1
  t++
  // if (t>9270) 
} while (!last) 
console.log("Step ",t,carts)